---
import BaseLayout from '../layouts/BaseLayout.astro'
---

<BaseLayout
  title="検索"
  description="技術ブログの記事を検索"
>
  <!-- Pagefind CSS -->
  <link href="/pagefind/pagefind-ui.css" rel="stylesheet" slot="head" />
  <script is:inline src="/pagefind/pagefind-ui.js" slot="head"></script>

  <div class="max-w-5xl mx-auto">
    <h1 class="text-4xl font-bold mb-8">検索</h1>

    <!-- Pagefind検索UI -->
    <div id="search" class="mb-8"></div>
  </div>
</BaseLayout>

<script is:inline>
  // Pagefind UIを初期化
  window.addEventListener('DOMContentLoaded', () => {
    new window.PagefindUI({
      element: '#search',
      showSubResults: true,
      showImages: false,
      excerptLength: 100,
      resetStyles: false,
      translations: {
        placeholder: '記事を検索...',
        clear_search: 'クリア',
        load_more: 'さらに読み込む',
        search_label: '検索',
        filters_label: 'フィルター',
        zero_results: '検索結果が見つかりませんでした',
        many_results: '[COUNT]件の記事が見つかりました',
        one_result: '[COUNT]件の記事が見つかりました',
        alt_search: '検索:',
        search_suggestion: '検索結果がない場合は、別のキーワードを試してみてください',
        searching: '検索中...',
      },
    })
  })
</script>

<style is:global>
  /* Pagefind UIのカスタムスタイリング */
  #search {
    --pagefind-ui-scale: 1;
    --pagefind-ui-primary: var(--color-accent);
    --pagefind-ui-text: var(--color-text-main);
    --pagefind-ui-background: var(--color-bg);
    --pagefind-ui-border: var(--color-border);
    --pagefind-ui-tag: var(--color-code-bg);
    --pagefind-ui-border-width: 1px;
    --pagefind-ui-border-radius: 0.5rem;
    --pagefind-ui-image-border-radius: 0.5rem;
    --pagefind-ui-image-box-ratio: 3 / 2;
    --pagefind-ui-font: inherit;
  }

  /* 検索入力欄のスタイル */
  .pagefind-ui__search-input {
    background-color: var(--color-card-bg) !important;
    color: var(--color-text-main) !important;
    border-color: var(--color-border) !important;
  }

  .pagefind-ui__search-input:focus {
    border-color: var(--color-accent) !important;
    outline: none !important;
    box-shadow: 0 0 0 3px rgba(var(--color-accent-rgb), 0.1) !important;
  }

  /* 検索結果のスタイル */
  .pagefind-ui__result {
    background-color: var(--color-card-bg) !important;
    border-color: var(--color-border) !important;
  }

  .pagefind-ui__result:hover {
    border-color: var(--color-accent) !important;
  }

  .pagefind-ui__result-title {
    color: var(--color-text-main) !important;
  }

  .pagefind-ui__result-excerpt {
    color: var(--color-text-sub) !important;
  }

  /* ハイライトスタイル */
  .pagefind-ui__result-excerpt mark {
    background-color: rgba(var(--color-accent-rgb), 0.2) !important;
    color: var(--color-accent) !important;
    font-weight: 600;
  }

  /* クリアボタンを非表示 */
  .pagefind-ui__search-clear {
    display: none !important;
  }

  /* メッセージ */
  .pagefind-ui__message {
    color: var(--color-text-sub) !important;
  }
</style>
